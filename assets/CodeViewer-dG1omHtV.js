import{j as $}from"./jsx-runtime-DR9Q75dM.js";import{s as h,L as w}from"./LineNumbers-B_2_ToYE.js";import{r as C}from"./index-DRjF_FHU.js";import{u as b}from"./useCoachMarkStore-Bn0-Ay5q.js";const j=1e3,F=({code:n,codeLineList:s})=>{const[r,c]=C.useState([]),[a,o]=C.useState([]);return C.useEffect(()=>{const t=[];s.forEach((i,e)=>{(!r[e]||r[e]!==i)&&t.push(e)}),o(t);const u=setTimeout(()=>o([]),j);return c(s),()=>clearTimeout(u)},[n]),a},T=({styles:n,index:s,line:r,highlightedLines:c,selectedBlockStartLine:a,selectedBlockLength:o,selectedBlockType:t})=>{const u=c.includes(s)?n.newLine:"",i=a&&o&&s+1>=a&&s+1<a+o?n.blockHighlight:"",e=t&&r.includes(t)?n.highlightBg:"";return`${u} ${i} ${e}`.trim()},E=({code:n,type:s,styles:r,selectedBlockType:c})=>(s==="html"?x(n,r,c||""):_(n,r,c||"")).split(`
`).filter(o=>o.trim()!==""),S=({styles:n,theme:s,currentStep:r})=>`${n.viewer} ${s==="dark"?n.dark:n.light} ${r===3?"z-[200] bg-white":""}`,_=(n,s,r)=>{const c=n.split(`
`);let a=!1;return c.map(t=>r&&t.includes(`.${r}`)?(a=!0,`<span style="background-color: #FFF3AD;">${t}</span>`):a&&!t.includes("}")?`<span style="background-color: #FFF3AD;">${t}</span>`:a&&t.includes("}")?(a=!1,`<span style="background-color: #FFF3AD;">${t}</span>`):t.replace(/([^\s{}]+)\s*{/g,(u,i)=>{const e=r&&i.includes(`.${r}`)?`<span>${i}</span>`:i;return`<span class="${s.selector}">${e}</span> {`}).replace(/([\w-]+):/g,(u,i)=>`&nbsp;&nbsp;<span class="${s.property}">${i}</span>:`).replace(/:\s*([^;]+);/g,(u,i)=>`: <span class="${s["property-value"]}">${i}</span>;`)).join(`
`).split(`
`).map(t=>`  ${t}`).join(`
`)},x=(n,s,r)=>{const a=new DOMParser().parseFromString(n,"text/html"),o=(e,l)=>{const m="  ".repeat(l),d=`<span class="${s.tag}">${e.tagName.toLowerCase()}</span>`,p=Array.from(e.attributes).map(g=>{const v=g.name==="class"&&r&&g.value.includes(r)?g.value.replace(r,`<span style="background-color: #FFF3AD; color: green">${r}</span>`):g.value;return`<span class="${s.attribute}">${g.name}</span>=<span class="${s.value}">"${v}"</span>`}).join(" "),N=`${m}&lt;${d}${p?" "+p:""}&gt;`,L=`${m}&lt;/${d}&gt;`,f=Array.from(e.childNodes).map(g=>u(g,l+1)).join("");return["br","hr","img"].includes(e.tagName.toLowerCase())?`
${m}&lt;${d}${p?" "+p:""} /&gt;`:e.tagName.toLowerCase()==="head"?`${m}&lt;${d}${p?" "+p:""}&gt;${f.trim()}&lt;/${d}&gt;`:f.trim()?`
${N}
${f}
${L}`:`
${N}
${L}`},t=(e,l)=>{var p;const m=(p=e.textContent)==null?void 0:p.trim(),d="  ".repeat(l);return m?`
${d}<span class="${s.text}">${m}</span>`:""},u=(e,l=0)=>e.nodeType===Node.ELEMENT_NODE?o(e,l):e.nodeType===Node.TEXT_NODE?t(e,l):"";return u(a.documentElement,0).trim().split(`
`).map(e=>`  ${e}`).join(`
`)},A=({code:n,type:s,theme:r,selectedBlockStartLine:c,selectedBlockLength:a,selectedBlockType:o})=>{const t=E({code:n,type:s,styles:h,selectedBlockType:o}),u=F({code:n,codeLineList:t}),{currentStep:i}=b();return $.jsx("div",{className:S({styles:h,theme:r,currentStep:i}),children:$.jsxs("div",{className:h.scrollContainer,children:[$.jsx(w,{codeLineList:t}),$.jsx("pre",{className:h.codeContent,children:$.jsx("code",{children:t.map((e,l)=>$.jsx("div",{className:T({styles:h,index:l,line:e,highlightedLines:u,selectedBlockStartLine:c,selectedBlockLength:a,selectedBlockType:o}),dangerouslySetInnerHTML:{__html:e}},l))})})]})})};A.__docgenInfo={description:`@description
변환된 HTML, CSS 코드를 줄 수와 함께 보여주는 컴포넌트`,methods:[],displayName:"CodeViewer",props:{code:{required:!0,tsType:{name:"string"},description:""},type:{required:!0,tsType:{name:"union",raw:"'html' | 'css'",elements:[{name:"literal",value:"'html'"},{name:"literal",value:"'css'"}]},description:""},theme:{required:!1,tsType:{name:"union",raw:"'light' | 'dark'",elements:[{name:"literal",value:"'light'"},{name:"literal",value:"'dark'"}]},description:""},selectedBlockStartLine:{required:!1,tsType:{name:"number"},description:""},selectedBlockLength:{required:!1,tsType:{name:"number"},description:""},selectedBlockType:{required:!1,tsType:{name:"union",raw:"string | null",elements:[{name:"string"},{name:"null"}]},description:""}}};export{A as C};
